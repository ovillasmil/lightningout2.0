<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lightning Out 2.0 ‚Äì With Event Logging</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    #log { background: #f8f9fa; padding: 12px; border: 1px solid #ccc; margin-top: 16px; max-height: 300px; overflow: auto; }
    .event { margin-bottom: 8px; padding-left: 8px; border-left: 3px solid #0070d2; }
    .event.error { border-left-color: #c23934; }
    .event.ready { border-left-color: #2e844a; }
  </style>
</head>
<body>
  <h2>Lightning Out 2.0 Debug Embed</h2>
  <p>Status: <span id="status">Initializing...</span></p>

  <!-- üîë Required config -->
  <lightning-out-application 
    frontdoor-url="https://pghsa--full.sandbox.my.salesforce.com"
    components="c-gp-sfdc-out"></lightning-out-application>
  <c-gp-sfdc-out case-id="81863"></c-gp-sfdc-out>

  <!-- üìú Log area -->
  <div id="log">
    <div class="event">Listening for Lightning Out 2.0 events...</div>
  </div>

  <script>
    const log = document.getElementById('log');
    const status = document.getElementById('status');

    function addLog(message, type = 'info') {
      const el = document.createElement('div');
      el.className = `event ${type}`;
      el.innerHTML = `<strong>[${new Date().toLocaleTimeString()}] ${type.toUpperCase()}:</strong> ${message}`;
      log.appendChild(el);
      log.scrollTop = log.scrollHeight;
      console.log(`[${type.toUpperCase()}]`, message);
    }

    // üîî Listen to Lightning Out 2.0 custom events
    document.addEventListener('lo.application.ready', (event) => {
      status.textContent = '‚úÖ Salesforce session established';
      addLog('Salesforce session successfully established.', 'ready');
    });

    document.addEventListener('lo.application.error', (event) => {
      const { message, originalError } = event.detail;
      status.textContent = '‚ùå Salesforce session failed';
      addLog(`Application error: ${message}`, 'error');
      console.error('Original error:', originalError);
    });

    document.addEventListener('lo.component.ready', (event) => {
      status.textContent = '‚úÖ Component rendered';
      addLog('Lightning component rendered successfully.', 'ready');
    });

    document.addEventListener('lo.component.error', (event) => {
      const { message, originalError } = event.detail;
      status.textContent = '‚ùå Component error';
      addLog(`Component error: ${message}`, 'error');
      console.error('Component original error:', originalError);
    });

    // Load runtime
    const script = document.createElement('script');
    script.src = 'https://pghsa--full.sandbox.my.salesforce.com/lightning/lightning.out.latest/index.iife.prod.js';
    document.head.appendChild(script);
  </script>
</body>
</html>
